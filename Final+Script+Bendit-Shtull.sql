/*Creacion de tablas*/

Use hotel_model;

/* create guest table*/
CREATE TABLE IF NOT EXISTS huespedes(
	id_huesped int not null unique auto_increment,
	nombre varchar(100) not null,
	apellido varchar (100) not null,
	correo varchar(100) not null unique,
	telefono int(9),
	id_direccion int unique,
    primary key (id_huesped),
    foreign key (id_direccion) references direccion(id_direccion)
);

/* create address table*/
CREATE TABLE IF NOT EXISTS direccion(
	id_direccion int not null unique auto_increment,
    calle varchar(100) not null,
    num_ext int,
    num_int int,
    ciudad varchar(100),
    estado varchar(100),
    codigo_postal int(5) not null,
	pais varchar (100) not null,
    primary key (id_direccion)
);

/* create reservations table*/
CREATE TABLE IF NOT EXISTS reservaciones(
	id_reservacion int not null unique auto_increment,
    id_huesped int not null,
    id_habitacion int not null, 
    id_canal int not null,
    check_in date not null,
    check_out date not null,
    num_huespeded int(2),
    estatus varchar(100) not null default 'Reserved',
    primary key (id_reservacion),
    foreign key (id_huesped) references huespedes(id_huesped),
    foreign key (id_habitacion) references habitaciones(id_habitacion),
    foreign key (id_canal) references canales(id_canal)
);

/* create channel table*/
CREATE TABLE IF NOT EXISTS canales(
	id_canal int not null unique auto_increment,
    canal varchar (100) not null unique,
    comision DECIMAL(2,2) not null,
    primary key(id_canal)
);

/* create rooms table*/
CREATE TABLE IF NOT EXISTS habitaciones(
	id_habitacion int not null unique auto_increment,
    num_habitacion int not null unique,
    caregoria varchar(100) not null,
    tamano decimal (6,2) not null,
    piso int not null,
    vista_mar tinyint not null,
    cama_sofa tinyint not null,
    primary key(id_habitacion)
);

/* create additional purchases table*/
CREATE TABLE IF NOT EXISTS compra_adicional(
	id_compra_adictional int not null unique auto_increment,
    id_reservacion int not null,
    id_producto int not null,
    primary key (id_compra_adictional),
    foreign key (id_reservacion) references reservaciones(id_reservacion),
    foreign key (id_producto) references producto(id_producto)
);

/* create calendar rate table*/
CREATE TABLE IF NOT EXISTS calendario_tarifa(
	fecha date not null,
    id_habitacion int not null,
    tarifa_abierta_neta decimal(5,2) not null,
    tarifa_abierta_bruta decimal(5,2) not null,
    id_reservacion int,
    primary key(fecha, id_habitacion),
    foreign key (id_reservacion) references reservaciones(id_reservacion)
);

/* create extra products table*/
CREATE TABLE IF NOT EXISTS producto(
	id_producto int not null unique auto_increment,
    id_departamento int not null,
    nombre_producto varchar(100) not null,
    precio_neto decimal(5,2),
    precio_bruta decimal (5,2),
    primary key(id_producto),
    foreign key (id_departamento) references departamento(id_departamento)
);

/* create transactions table*/
CREATE TABLE IF NOT EXISTS transaccion(
	id_transaccion int not null unique auto_increment,
	id_reservacion int not null,
    monto decimal(6,2) not null,
    metodo_pago varchar(100) not null,
    estatus_pago tinyint not null default 0,
    primary key (id_transaccion),
    foreign key(id_reservacion) references reservaciones(id_reservacion)
);

/* create department table*/
CREATE TABLE IF NOT EXISTS departamento(
	id_departamento int not null unique auto_increment,
	nombre_departamento varchar(100) not null unique,
    primary key(id_departamento)
);

/*Insercion de datos*/
INSERT INTO habitaciones (num_habitacion,categoria,tamano,piso,vista_mar,cama_sofa)
VALUES 
	(1,'DD',40,1,0,0),
	(2,'K',50,1,0,1),
	(3,'DD',40,1,0,0),
	(4,'K',50,1,0,0),
	(5,'DD',40,1,0,0),
	(6,'K',50,1,1,0),
	(7,'DD',40,1,1,1),
	(8,'K',50,1,1,1),
	(9,'DD',40,1,1,1),
	(10,'K',50,1,1,1),
	(11,'DD',45,2,0,0),
	(12,'DD',45,2,0,0),
	(13,'DD',45,2,0,0),
	(14,'DD',45,2,0,0),
	(15,'K',45,2,1,1),
	(16,'K',45,2,1,1),
	(17,'K',45,2,1,1),
	(18,'K',45,2,1,1),
	(19,'Suite',70,3,1,1),
	(20,'Suite',70,3,1,1);

INSERT INTO canales (canal,comision)
Value
	('Expedia',0.13),
	('Booking.com',0.15),
	('Website',0.02),
	('Airbnb',0.03),
	('Call Center',0.02),
	('Sales',0.05),
	('Comp',0),
	('Internal Stay',0);

INSERT INTO departamento (nombre_departamento)
VALUES 
	('Rooms'),
	('Casual Restaurant 1'),
	('Casual Restaurant 2'),
	('Speciality Restaurant 1'),
	('Speciality Restaurant 2'),
	('Cafe'),
	('Gift Shop'),
	('Spa'),
	('Spa Shop'),
	('Golf'),
	('Kids Club');

Insert into producto (id_departamento, nombre_producto, precio_neto, precio_bruta)
Values
	(1,'Minibar',10,11.6),
	(2,'Sandwich',20,23.2),
	(3,'Croissant',7,8.12),
	(4,'Steak',40,46.4),
	(5,'Pickels',3,3.48),
	(6,'Coffee',6,6.96),
	(7,'Sunscreen',10,11.6),
	(8,'Massage',70,81.2),
	(9,'Oil',40,46.4),
	(10,'Clubs',100,116),
	(11,'Activity',20,23.2);

Insert into direccion (calle,num_ext,num_int,ciudad,estado,codigo_postal,pais)
Values
	('1150 Tincidunt Rd.',66,29,'Phát Diệm','Sachsen-Anhalt',52114,'Indonesia'),
	('386-512 Laoreet Rd.',78,60,'Paya Lebar','Huáběi',411676,'Australia'),
	('299-2657 Luctus Road',78,13,'Quesada','Ulster',313642,'Nigeria'),
	('790-7530 Nunc Rd.',62,98,'Dunedin','Piura',615634,'Brazil'),
	('4994 Sagittis. Rd.',2,100,'Warszawa','Andaman and Nicobar Islands',11111,'Italy'),
	('Ap #621-9339 Tempor, Av.',80,9,'Dublin','West Region',812261,'Colombia'),
	('Ap #529-1150 Fringilla Av.',85,35,'Kırıkhan','Papua',11111,'Ukraine'),
	('721-3538 Sed, Rd.',5,8,'Rio Verde','Vologda Oblast',20274,'Turkey'),
	('924 Consectetuer Rd.',89,23,'Meix-le-Tige','Lagos',52742,'Canada'),
	('943-1231 Phasellus St.',98,40,'Gorontalo','Gävleborgs län',441722,'Nigeria'),
	('986 Mi Road',63,43,'Ang Mo Kio','San Luis Potosí',537837,'Ireland'),
	('Ap #360-8130 Magnis Ave',82,84,'Jacksonville','Cantabria',71845,'Russian Federation'),
	('Ap #975-5352 Egestas. Avenue',8,17,'Vashkivtsi','Puntarenas',412254,'Brazil'),
	('773-1456 Nibh Street',67,8,'Sale','Saskatchewan',52114,'United Kingdom'),
	('Ap #495-8048 Amet, Avenue',80,77,'La Carlota','Azad Kashmir',52114,'Russian Federation'),
	('Ap #469-5215 Volutpat. St.',76,77,'Kraków','Møre og Romsdal',52114,'Russian Federation'),
	('P.O. Box 546, 5284 Nunc Road',100,60,'San Miguel','Nova Scotia',78431,'Australia'),
	('P.O. Box 741, 1618 Ultricies Street',52,80,'Castelló','Western Cape',1036,'Australia'),
	('856-6323 Pede Street',9,8,'Barranca','Zuid Holland',52114,'Ireland'),
	('380-371 Nascetur St.',96,74,'Waiheke Island','Salzburg',52114,'Netherlands'),
	('475-8257 Cras Av.',83,43,'Zhytomyr','Xīnán',473089,'Italy'),
	('Ap #352-4894 Interdum Ave',80,15,'Godhra','Munster',811397,'Canada'),
	('212-6929 Quisque Rd.',23,28,'Da Lat','Sinaloa',362034,'Philippines'),
	('847-1123 Vivamus St.',39,78,'Bischofshofen','North Maluku',3187,'United Kingdom'),
	('517-1241 Nunc Road',92,16,'Jacksonville','Upper Austria',26815,'Pakistan'),
	('1937 Dui Av.',93,83,'Hazaribag','North West',546143,'Pakistan'),
	('7733 Hendrerit Rd.',93,80,'Krems an der Donau','Querétaro',4846,'Turkey'),
	('Ap #187-1900 Mauris Rd.',96,8,'Lambayeque','Prince Edward Island',78358,'China'),
	('280-7800 Suspendisse Road',64,20,'Bathurst','Zakarpattia oblast',7817,'Singapore'),
	('672-5930 Et St.',18,56,'Voitsberg','Aydın',331268474,'Austria');
    
Insert into huespedes (nombre, apellido, correo,id_direccion,telefono)
Values
	('Sarah','Nelson','s.nelson@randatmail.com',1,'69266872'),
	('Sam','Alexander','s.alexander@randatmail.com',2,'139368177'),
	('Aiden','Barnes','a.barnes@randatmail.com',3,'386067202'),
	('Thomas','Cameron','t.cameron@randatmail.com',4,'264495825'),
	('James','Thomas','j.thomas@randatmail.com',5,'750272607'),
	('Darcy','Miller','d.miller@randatmail.com',6,'671209830'),
	('Emily','Cole','e.cole@randatmail.com',7,'289120313'),
	('Wilson','Murray','w.murray@randatmail.com',8,'897316313'),
	('Eric','Payne','e.payne@randatmail.com',9,'421436772'),
	('Reid','Warren','r.warren@randatmail.com',10,'960428159'),
	('Sienna','Grant','s.grant@randatmail.com',11,'651005189'),
	('Edwin','Campbell','e.campbell@randatmail.com',12,'746938028'),
	('Kelsey','Harrison','k.harrison@randatmail.com',13,'108974551'),
	('Melanie','Cole','m.cole@randatmail.com',14,'406483992'),
	('Bruce','Cooper','b.cooper@randatmail.com',15,'224960197'),
	('Aston','Cooper','a.cooper@randatmail.com',16,'875768104'),
	('Alissa','Smith','a.smith@randatmail.com',17,'460507328'),
	('Kellan','Morgan','k.morgan@randatmail.com',18,'843876581'),
	('Violet','Scott','v.scott@randatmail.com',19,'13365586'),
	('Kate','Johnston','k.johnston@randatmail.com',20,'672196721'),
	('Audrey','Stevens','a.stevens@randatmail.com',21,'395432077'),
	('Lilianna','Montgomery','l.montgomery@randatmail.com',22,'899471467'),
	('Elise','Cunningham','e.cunningham@randatmail.com',23,'491890231'),
	('Natalie','Higgins','n.higgins@randatmail.com',24,'378502704'),
	('Amelia','Evans','a.evans@randatmail.com',25,'568633129'),
	('Victor','Miller','v.miller@randatmail.com',26,'985302247'),
	('Dainton','Russell','d.russell@randatmail.com',27,'872036127'),
	('Oscar','Stevens','o.stevens@randatmail.com',28,'954458966'),
	('Belinda','Alexander','b.alexander@randatmail.com',29,'261513176'),
	('April','Grant','a.grant@randatmail.com',30,'346785858');
    
INSERT INTO reservaciones (id_huesped,id_habitacion, id_canal, check_in, check_out, num_huespeded, estatus)
Values
	(4,1,3, '2022-12-01', '2022-12-06', 4, 'Cancelled'),
	(1,1,4, '2022-12-09', '2022-12-14', 4, 'Confirmed'),
	(12,1,8, '2022-12-15', '2022-12-25', 1, 'Confirmed'),
	(14,2,6, '2022-12-02', '2022-12-12', 2, 'Confirmed'),
	(24,2,2, '2022-12-17', '2022-12-20', 2, 'Confirmed'),
	(8,2,7, '2022-12-21', '2022-12-23', 1, 'Confirmed'),
	(4,2,2, '2022-12-24', '2022-12-29', 3, 'Confirmed'),
	(5,3,4, '2022-12-05', '2022-12-10', 4, 'Confirmed'),
	(22,3,5, '2022-12-10', '2022-12-13', 1, 'Confirmed'),
	(2,4,3, '2022-12-01', '2022-12-31', 2, 'Confirmed'),
	(26,5,1, '2022-12-01', '2022-12-06', 2, 'Confirmed'),
	(23,5,4, '2022-12-11', '2022-12-17', 4, 'Confirmed'),
	(25,6,7, '2022-12-04', '2022-12-14', 2, 'Confirmed'),
	(18,6,4, '2022-12-17', '2022-12-22', 3, 'Confirmed'),
	(30,6,7, '2022-12-26', '2022-12-27', 3, 'Confirmed'),
	(2,7,2, '2022-12-01', '2022-12-03', 1, 'Confirmed'),
	(13,7,7, '2022-12-08', '2022-12-14', 3, 'Confirmed'),
	(13,7,5, '2022-12-14', '2022-12-21', 2, 'Confirmed'),
	(8,7,8, '2022-12-22', '2022-12-27', 2, 'Cancelled'),
	(2,8,7, '2022-12-04', '2022-12-08', 4, 'Confirmed'),
	(16,8,5, '2022-12-08', '2022-12-10', 4, 'Confirmed'),
	(22,9,3, '2022-12-01', '2022-12-05', 1, 'Confirmed'),
	(15,9,1, '2022-12-08', '2022-12-23', 3, 'Confirmed'),
	(9,10,3, '2022-12-08', '2022-12-09', 4, 'Confirmed'),
	(22,10,7, '2022-12-12', '2022-12-16', 2, 'Confirmed'),
	(9,10,4, '2022-12-16', '2022-12-17', 2, 'Confirmed'),
	(25,10,7, '2022-12-20', '2022-12-24', 4, 'Confirmed'),
	(11,10,8, '2022-12-24', '2022-12-29', 1, 'Confirmed'),
	(18,10,6, '2022-12-29', '2022-12-31', 3, 'Confirmed'),
	(9,11,5, '2022-12-01', '2022-12-11', 1, 'Confirmed'),
	(16,11,7, '2022-12-12', '2022-12-16', 4, 'Confirmed'),
	(4,11,8, '2022-12-17', '2022-12-22', 3, 'Confirmed'),
	(19,11,5, '2022-12-23', '2022-12-28', 3, 'Confirmed'),
	(18,11,4, '2022-12-28', '2022-12-29', 2, 'Confirmed'),
	(29,12,3, '2022-12-01', '2022-12-03', 4, 'Confirmed'),
	(2,12,1, '2022-12-08', '2022-12-14', 1, 'Confirmed'),
	(22,12,2, '2022-12-14', '2022-12-21', 2, 'Confirmed'),
	(6,12,6, '2022-12-22', '2022-12-27', 2, 'Confirmed'),
	(1,13,6, '2022-12-02', '2022-12-12', 1, 'Confirmed'),
	(7,13,8, '2022-12-17', '2022-12-20', 3, 'Confirmed'),
	(13,13,7, '2022-12-21', '2022-12-23', 1, 'Confirmed'),
	(1,13,1, '2022-12-24', '2022-12-29', 4, 'Confirmed'),
	(13,14,2, '2022-12-01', '2022-12-06', 2, 'Confirmed'),
	(27,14,7, '2022-12-11', '2022-12-17', 4, 'Confirmed'),
	(1,15,4, '2022-12-02', '2022-12-12', 2, 'Confirmed'),
	(11,15,8, '2022-12-17', '2022-12-20', 4, 'Cancelled'),
	(21,15,4, '2022-12-21', '2022-12-23', 4, 'Confirmed'),
	(23,15,3, '2022-12-24', '2022-12-29', 2, 'Confirmed'),
	(14,16,8, '2022-12-01', '2022-12-06', 3, 'Confirmed'),
	(29,16,5, '2022-12-11', '2022-12-17', 1, 'Confirmed'),
	(25,17,2, '2022-12-04', '2022-12-19', 1, 'Confirmed'),
	(18,18,5, '2022-12-08', '2022-12-09', 1, 'Cancelled'),
	(9,18,8, '2022-12-12', '2022-12-16', 2, 'Confirmed'),
	(12,18,1, '2022-12-16', '2022-12-17', 1, 'Confirmed'),
	(28,18,4, '2022-12-20', '2022-12-24', 3, 'Confirmed'),
	(30,18,7, '2022-12-24', '2022-12-29', 1, 'Confirmed'),
	(26,19,5, '2022-12-04', '2022-12-08', 4, 'Confirmed'),
	(6,19,2, '2022-12-08', '2022-12-10', 4, 'Confirmed'),
	(28,19,1, '2022-12-11', '2022-12-13', 4, 'Confirmed'),
	(17,20,4, '2022-12-01', '2022-12-21', 2, 'Confirmed');
    
INSERT INTO calendario_tarifa (Fecha,id_habitacion,tarifa_abierta_neta,tarifa_abierta_bruta,id_reservacion)
Values
	('2022-12-01', 1, 436, 505.76, 1),
	('2022-12-02', 1, 433, 502.28, 1),
	('2022-12-03', 1, 491, 569.56, 1),
	('2022-12-04', 1, 309, 358.44, 1),
	('2022-12-05', 1, 349, 404.84, 1),
	('2022-12-06', 1, 441, 511.56, Null),
	('2022-12-07', 1, 488, 566.08, Null),
	('2022-12-08', 1, 453, 525.48, Null),
	('2022-12-09', 1, 316, 366.56, 2),
	('2022-12-10', 1, 370, 429.2, 2),
	('2022-12-11', 1, 357, 414.12, 2),
	('2022-12-12', 1, 376, 436.16, 2),
	('2022-12-13', 1, 313, 363.08, 2),
	('2022-12-14', 1, 350, 406, Null),
	('2022-12-15', 1, 345, 400.2, 3),
	('2022-12-16', 1, 467, 541.72, 3),
	('2022-12-17', 1, 448, 519.68, 3),
	('2022-12-18', 1, 309, 358.44, 3),
	('2022-12-19', 1, 394, 457.04, 3),
	('2022-12-20', 1, 303, 351.48, 3),
	('2022-12-21', 1, 472, 547.52, 3),
	('2022-12-22', 1, 302, 350.32, 3),
	('2022-12-23', 1, 402, 466.32, 3),
	('2022-12-24', 1, 325, 377, 3),
	('2022-12-25', 1, 438, 508.08, Null),
	('2022-12-26', 1, 438, 508.08, Null),
	('2022-12-27', 1, 319, 370.04, Null),
	('2022-12-28', 1, 474, 549.84, Null),
	('2022-12-29', 1, 447, 518.52, Null),
	('2022-12-30', 1, 327, 379.32, Null),
	('2022-12-31', 1, 372, 431.52, Null),
	('2022-12-01', 2, 376, 436.16, Null),
	('2022-12-02', 2, 351, 407.16, 4),
	('2022-12-03', 2, 359, 416.44, 4),
	('2022-12-04', 2, 471, 546.36, 4),
	('2022-12-05', 2, 401, 465.16, 4),
	('2022-12-06', 2, 340, 394.4, 4),
	('2022-12-07', 2, 483, 560.28, 4),
	('2022-12-08', 2, 319, 370.04, 4),
	('2022-12-09', 2, 401, 465.16, 4),
	('2022-12-10', 2, 382, 443.12, 4),
	('2022-12-11', 2, 432, 501.12, 4),
	('2022-12-12', 2, 375, 435, Null),
	('2022-12-13', 2, 343, 397.88, Null),
	('2022-12-14', 2, 481, 557.96, Null),
	('2022-12-15', 2, 462, 535.92, Null),
	('2022-12-16', 2, 411, 476.76, Null),
	('2022-12-17', 2, 491, 569.56, 5),
	('2022-12-18', 2, 435, 504.6, 5),
	('2022-12-19', 2, 357, 414.12, 5),
	('2022-12-20', 2, 363, 421.08, Null),
	('2022-12-21', 2, 415, 481.4, 6),
	('2022-12-22', 2, 307, 356.12, 6),
	('2022-12-23', 2, 428, 496.48, Null),
	('2022-12-24', 2, 470, 545.2, 7),
	('2022-12-25', 2, 409, 474.44, 7),
	('2022-12-26', 2, 459, 532.44, 7),
	('2022-12-27', 2, 480, 556.8, 7),
	('2022-12-28', 2, 349, 404.84, 7),
	('2022-12-29', 2, 468, 542.88, Null),
	('2022-12-30', 2, 410, 475.6, Null),
	('2022-12-31', 2, 356, 412.96, Null),
	('2022-12-01', 3, 489, 567.24, Null),
	('2022-12-02', 3, 324, 375.84, Null),
	('2022-12-03', 3, 376, 436.16, Null),
	('2022-12-04', 3, 496, 575.36, Null),
	('2022-12-05', 3, 384, 445.44, 8),
	('2022-12-06', 3, 449, 520.84, 8),
	('2022-12-07', 3, 431, 499.96, 8),
	('2022-12-08', 3, 396, 459.36, 8),
	('2022-12-09', 3, 310, 359.6, 8),
	('2022-12-10', 3, 432, 501.12, 9),
	('2022-12-11', 3, 342, 396.72, 9),
	('2022-12-12', 3, 320, 371.2, 9),
	('2022-12-13', 3, 375, 435, Null),
	('2022-12-14', 3, 403, 467.48, Null),
	('2022-12-15', 3, 371, 430.36, Null),
	('2022-12-16', 3, 447, 518.52, Null),
	('2022-12-17', 3, 333, 386.28, Null),
	('2022-12-18', 3, 489, 567.24, Null),
	('2022-12-19', 3, 497, 576.52, Null),
	('2022-12-20', 3, 322, 373.52, Null),
	('2022-12-21', 3, 499, 578.84, Null),
	('2022-12-22', 3, 331, 383.96, Null),
	('2022-12-23', 3, 300, 348, Null),
	('2022-12-24', 3, 357, 414.12, Null),
	('2022-12-25', 3, 342, 396.72, Null),
	('2022-12-26', 3, 466, 540.56, Null),
	('2022-12-27', 3, 438, 508.08, Null),
	('2022-12-28', 3, 361, 418.76, Null),
	('2022-12-29', 3, 398, 461.68, Null),
	('2022-12-30', 3, 373, 432.68, Null),
	('2022-12-31', 3, 300, 348, Null),
	('2022-12-01', 4, 429, 497.64, 10),
	('2022-12-02', 4, 432, 501.12, 10),
	('2022-12-03', 4, 430, 498.8, 10),
	('2022-12-04', 4, 469, 544.04, 10),
	('2022-12-05', 4, 340, 394.4, 10),
	('2022-12-06', 4, 378, 438.48, 10),
	('2022-12-07', 4, 410, 475.6, 10),
	('2022-12-08', 4, 357, 414.12, 10),
	('2022-12-09', 4, 361, 418.76, 10),
	('2022-12-10', 4, 421, 488.36, 10),
	('2022-12-11', 4, 375, 435, 10),
	('2022-12-12', 4, 362, 419.92, 10),
	('2022-12-13', 4, 428, 496.48, 10),
	('2022-12-14', 4, 409, 474.44, 10),
	('2022-12-15', 4, 483, 560.28, 10),
	('2022-12-16', 4, 330, 382.8, 10),
	('2022-12-17', 4, 392, 454.72, 10),
	('2022-12-18', 4, 426, 494.16, 10),
	('2022-12-19', 4, 409, 474.44, 10),
	('2022-12-20', 4, 388, 450.08, 10),
	('2022-12-21', 4, 337, 390.92, 10),
	('2022-12-22', 4, 435, 504.6, 10),
	('2022-12-23', 4, 398, 461.68, 10),
	('2022-12-24', 4, 398, 461.68, 10),
	('2022-12-25', 4, 480, 556.8, 10),
	('2022-12-26', 4, 478, 554.48, 10),
	('2022-12-27', 4, 317, 367.72, 10),
	('2022-12-28', 4, 437, 506.92, 10),
	('2022-12-29', 4, 318, 368.88, 10),
	('2022-12-30', 4, 303, 351.48, 10),
	('2022-12-31', 4, 430, 498.8, Null),
	('2022-12-01', 5, 428, 496.48, 11),
	('2022-12-02', 5, 388, 450.08, 11),
	('2022-12-03', 5, 373, 432.68, 11),
	('2022-12-04', 5, 406, 470.96, 11),
	('2022-12-05', 5, 310, 359.6, 11),
	('2022-12-06', 5, 373, 432.68, Null),
	('2022-12-07', 5, 325, 377, Null),
	('2022-12-08', 5, 384, 445.44, Null),
	('2022-12-09', 5, 364, 422.24, Null),
	('2022-12-10', 5, 411, 476.76, Null),
	('2022-12-11', 5, 334, 387.44, 12),
	('2022-12-12', 5, 354, 410.64, 12),
	('2022-12-13', 5, 490, 568.4, 12),
	('2022-12-14', 5, 434, 503.44, 12),
	('2022-12-15', 5, 460, 533.6, 12),
	('2022-12-16', 5, 432, 501.12, 12),
	('2022-12-17', 5, 370, 429.2, Null),
	('2022-12-18', 5, 305, 353.8, Null),
	('2022-12-19', 5, 352, 408.32, Null),
	('2022-12-20', 5, 463, 537.08, Null),
	('2022-12-21', 5, 354, 410.64, Null),
	('2022-12-22', 5, 304, 352.64, Null),
	('2022-12-23', 5, 440, 510.4, Null),
	('2022-12-24', 5, 493, 571.88, Null),
	('2022-12-25', 5, 330, 382.8, Null),
	('2022-12-26', 5, 459, 532.44, Null),
	('2022-12-27', 5, 321, 372.36, Null),
	('2022-12-28', 5, 347, 402.52, Null),
	('2022-12-29', 5, 478, 554.48, Null),
	('2022-12-30', 5, 425, 493, Null),
	('2022-12-31', 5, 351, 407.16, Null),
	('2022-12-01', 6, 451, 523.16, Null),
	('2022-12-02', 6, 353, 409.48, Null),
	('2022-12-03', 6, 372, 431.52, Null),
	('2022-12-04', 6, 312, 361.92, 13),
	('2022-12-05', 6, 351, 407.16, 13),
	('2022-12-06', 6, 460, 533.6, 13),
	('2022-12-07', 6, 351, 407.16, 13),
	('2022-12-08', 6, 456, 528.96, 13),
	('2022-12-09', 6, 307, 356.12, 13),
	('2022-12-10', 6, 365, 423.4, 13),
	('2022-12-11', 6, 379, 439.64, 13),
	('2022-12-12', 6, 399, 462.84, 13),
	('2022-12-13', 6, 432, 501.12, 13),
	('2022-12-14', 6, 419, 486.04, Null),
	('2022-12-15', 6, 311, 360.76, Null),
	('2022-12-16', 6, 482, 559.12, Null),
	('2022-12-17', 6, 433, 502.28, 14),
	('2022-12-18', 6, 346, 401.36, 14),
	('2022-12-19', 6, 375, 435, 14),
	('2022-12-20', 6, 489, 567.24, 14),
	('2022-12-21', 6, 484, 561.44, 14),
	('2022-12-22', 6, 318, 368.88, Null),
	('2022-12-23', 6, 418, 484.88, Null),
	('2022-12-24', 6, 478, 554.48, Null),
	('2022-12-25', 6, 345, 400.2, Null),
	('2022-12-26', 6, 397, 460.52, 15),
	('2022-12-27', 6, 396, 459.36, Null),
	('2022-12-28', 6, 475, 551, Null),
	('2022-12-29', 6, 375, 435, Null),
	('2022-12-30', 6, 336, 389.76, Null),
	('2022-12-31', 6, 417, 483.72, Null),
	('2022-12-01', 7, 343, 397.88, 16),
	('2022-12-02', 7, 451, 523.16, 16),
	('2022-12-03', 7, 484, 561.44, Null),
	('2022-12-04', 7, 499, 578.84, Null),
	('2022-12-05', 7, 454, 526.64, Null),
	('2022-12-06', 7, 341, 395.56, Null),
	('2022-12-07', 7, 360, 417.6, Null),
	('2022-12-08', 7, 448, 519.68, 17),
	('2022-12-09', 7, 444, 515.04, 17),
	('2022-12-10', 7, 495, 574.2, 17),
	('2022-12-11', 7, 357, 414.12, 17),
	('2022-12-12', 7, 493, 571.88, 17),
	('2022-12-13', 7, 424, 491.84, 17),
	('2022-12-14', 7, 314, 364.24, 18),
	('2022-12-15', 7, 317, 367.72, 18),
	('2022-12-16', 7, 380, 440.8, 18),
	('2022-12-17', 7, 305, 353.8, 18),
	('2022-12-18', 7, 453, 525.48, 18),
	('2022-12-19', 7, 387, 448.92, 18),
	('2022-12-20', 7, 483, 560.28, 18),
	('2022-12-21', 7, 326, 378.16, Null),
	('2022-12-22', 7, 346, 401.36, 19),
	('2022-12-23', 7, 310, 359.6, 19),
	('2022-12-24', 7, 327, 379.32, 19),
	('2022-12-25', 7, 316, 366.56, 19),
	('2022-12-26', 7, 304, 352.64, 19),
	('2022-12-27', 7, 311, 360.76, Null),
	('2022-12-28', 7, 459, 532.44, Null),
	('2022-12-29', 7, 313, 363.08, Null),
	('2022-12-30', 7, 381, 441.96, Null),
	('2022-12-31', 7, 388, 450.08, Null),
	('2022-12-01', 8, 374, 433.84, Null),
	('2022-12-02', 8, 324, 375.84, Null),
	('2022-12-03', 8, 325, 377, Null),
	('2022-12-04', 8, 335, 388.6, 20),
	('2022-12-05', 8, 400, 464, 20),
	('2022-12-06', 8, 435, 504.6, 20),
	('2022-12-07', 8, 462, 535.92, 20),
	('2022-12-08', 8, 402, 466.32, 21),
	('2022-12-09', 8, 440, 510.4, 21),
	('2022-12-10', 8, 343, 397.88, Null),
	('2022-12-11', 8, 436, 505.76, Null),
	('2022-12-12', 8, 487, 564.92, Null),
	('2022-12-13', 8, 424, 491.84, Null),
	('2022-12-14', 8, 319, 370.04, Null),
	('2022-12-15', 8, 301, 349.16, Null),
	('2022-12-16', 8, 494, 573.04, Null),
	('2022-12-17', 8, 410, 475.6, Null),
	('2022-12-18', 8, 383, 444.28, Null),
	('2022-12-19', 8, 351, 407.16, Null),
	('2022-12-20', 8, 366, 424.56, Null),
	('2022-12-21', 8, 357, 414.12, Null),
	('2022-12-22', 8, 323, 374.68, Null),
	('2022-12-23', 8, 423, 490.68, Null),
	('2022-12-24', 8, 355, 411.8, Null),
	('2022-12-25', 8, 351, 407.16, Null),
	('2022-12-26', 8, 495, 574.2, Null),
	('2022-12-27', 8, 362, 419.92, Null),
	('2022-12-28', 8, 482, 559.12, Null),
	('2022-12-29', 8, 348, 403.68, Null),
	('2022-12-30', 8, 454, 526.64, Null),
	('2022-12-31', 8, 485, 562.6, Null),
	('2022-12-01', 9, 303, 351.48, 22),
	('2022-12-02', 9, 445, 516.2, 22),
	('2022-12-03', 9, 353, 409.48, 22),
	('2022-12-04', 9, 388, 450.08, 22),
	('2022-12-05', 9, 423, 490.68, Null),
	('2022-12-06', 9, 408, 473.28, Null),
	('2022-12-07', 9, 414, 480.24, Null),
	('2022-12-08', 9, 301, 349.16, 23),
	('2022-12-09', 9, 425, 493, 23),
	('2022-12-10', 9, 354, 410.64, 23),
	('2022-12-11', 9, 377, 437.32, 23),
	('2022-12-12', 9, 439, 509.24, 23),
	('2022-12-13', 9, 363, 421.08, 23),
	('2022-12-14', 9, 387, 448.92, 23),
	('2022-12-15', 9, 387, 448.92, 23),
	('2022-12-16', 9, 486, 563.76, 23),
	('2022-12-17', 9, 317, 367.72, 23),
	('2022-12-18', 9, 373, 432.68, 23),
	('2022-12-19', 9, 388, 450.08, 23),
	('2022-12-20', 9, 439, 509.24, 23),
	('2022-12-21', 9, 433, 502.28, 23),
	('2022-12-22', 9, 390, 452.4, 23),
	('2022-12-23', 9, 416, 482.56, Null),
	('2022-12-24', 9, 300, 348, Null),
	('2022-12-25', 9, 400, 464, Null),
	('2022-12-26', 9, 345, 400.2, Null),
	('2022-12-27', 9, 326, 378.16, Null),
	('2022-12-28', 9, 418, 484.88, Null),
	('2022-12-29', 9, 358, 415.28, Null),
	('2022-12-30', 9, 425, 493, Null),
	('2022-12-31', 9, 472, 547.52, Null),
	('2022-12-01', 10, 362, 419.92, Null),
	('2022-12-02', 10, 396, 459.36, Null),
	('2022-12-03', 10, 425, 493, Null),
	('2022-12-04', 10, 330, 382.8, Null),
	('2022-12-05', 10, 346, 401.36, Null),
	('2022-12-06', 10, 423, 490.68, Null),
	('2022-12-07', 10, 386, 447.76, Null),
	('2022-12-08', 10, 391, 453.56, 24),
	('2022-12-09', 10, 485, 562.6, Null),
	('2022-12-10', 10, 480, 556.8, Null),
	('2022-12-11', 10, 356, 412.96, Null),
	('2022-12-12', 10, 369, 428.04, 25),
	('2022-12-13', 10, 325, 377, 25),
	('2022-12-14', 10, 424, 491.84, 25),
	('2022-12-15', 10, 481, 557.96, 25),
	('2022-12-16', 10, 468, 542.88, 26),
	('2022-12-17', 10, 400, 464, Null),
	('2022-12-18', 10, 392, 454.72, Null),
	('2022-12-19', 10, 448, 519.68, Null),
	('2022-12-20', 10, 463, 537.08, 27),
	('2022-12-21', 10, 481, 557.96, 27),
	('2022-12-22', 10, 385, 446.6, 27),
	('2022-12-23', 10, 492, 570.72, Null),
	('2022-12-24', 10, 366, 424.56, 28),
	('2022-12-25', 10, 340, 394.4, 28),
	('2022-12-26', 10, 300, 348, 28),
	('2022-12-27', 10, 419, 486.04, 28),
	('2022-12-28', 10, 368, 426.88, 28),
	('2022-12-29', 10, 398, 461.68, 29),
	('2022-12-30', 10, 418, 484.88, 29),
	('2022-12-31', 10, 479, 555.64, Null),
	('2022-12-01', 11, 468, 542.88, 30),
	('2022-12-02', 11, 330, 382.8, 30),
	('2022-12-03', 11, 412, 477.92, 30),
	('2022-12-04', 11, 389, 451.24, 30),
	('2022-12-05', 11, 467, 541.72, 30),
	('2022-12-06', 11, 339, 393.24, 30),
	('2022-12-07', 11, 366, 424.56, 30),
	('2022-12-08', 11, 418, 484.88, 30),
	('2022-12-09', 11, 394, 457.04, 30),
	('2022-12-10', 11, 465, 539.4, 30),
	('2022-12-11', 11, 435, 504.6, Null),
	('2022-12-12', 11, 489, 567.24, 31),
	('2022-12-13', 11, 434, 503.44, 31),
	('2022-12-14', 11, 370, 429.2, 31),
	('2022-12-15', 11, 345, 400.2, 31),
	('2022-12-16', 11, 491, 569.56, Null),
	('2022-12-17', 11, 326, 378.16, 32),
	('2022-12-18', 11, 322, 373.52, 32),
	('2022-12-19', 11, 373, 432.68, 32),
	('2022-12-20', 11, 472, 547.52, 32),
	('2022-12-21', 11, 319, 370.04, 32),
	('2022-12-22', 11, 354, 410.64, Null),
	('2022-12-23', 11, 302, 350.32, 33),
	('2022-12-24', 11, 402, 466.32, 33),
	('2022-12-25', 11, 372, 431.52, 33),
	('2022-12-26', 11, 494, 573.04, 33),
	('2022-12-27', 11, 453, 525.48, 33),
	('2022-12-28', 11, 499, 578.84, 34),
	('2022-12-29', 11, 325, 377, Null),
	('2022-12-30', 11, 426, 494.16, Null),
	('2022-12-31', 11, 405, 469.8, Null),
	('2022-12-01', 12, 350, 406, 35),
	('2022-12-02', 12, 486, 563.76, 35),
	('2022-12-03', 12, 467, 541.72, Null),
	('2022-12-04', 12, 384, 445.44, Null),
	('2022-12-05', 12, 365, 423.4, Null),
	('2022-12-06', 12, 411, 476.76, Null),
	('2022-12-07', 12, 410, 475.6, Null),
	('2022-12-08', 12, 495, 574.2, 36),
	('2022-12-09', 12, 340, 394.4, 36),
	('2022-12-10', 12, 304, 352.64, 36),
	('2022-12-11', 12, 356, 412.96, 36),
	('2022-12-12', 12, 437, 506.92, 36),
	('2022-12-13', 12, 467, 541.72, 36),
	('2022-12-14', 12, 310, 359.6, 37),
	('2022-12-15', 12, 500, 580, 37),
	('2022-12-16', 12, 311, 360.76, 37),
	('2022-12-17', 12, 333, 386.28, 37),
	('2022-12-18', 12, 302, 350.32, 37),
	('2022-12-19', 12, 426, 494.16, 37),
	('2022-12-20', 12, 439, 509.24, 37),
	('2022-12-21', 12, 447, 518.52, Null),
	('2022-12-22', 12, 387, 448.92, 38),
	('2022-12-23', 12, 357, 414.12, 38),
	('2022-12-24', 12, 416, 482.56, 38),
	('2022-12-25', 12, 448, 519.68, 38),
	('2022-12-26', 12, 320, 371.2, 38),
	('2022-12-27', 12, 363, 421.08, Null),
	('2022-12-28', 12, 478, 554.48, Null),
	('2022-12-29', 12, 344, 399.04, Null),
	('2022-12-30', 12, 416, 482.56, Null),
	('2022-12-31', 12, 442, 512.72, Null),
	('2022-12-01', 13, 420, 487.2, Null),
	('2022-12-02', 13, 407, 472.12, 39),
	('2022-12-03', 13, 381, 441.96, 39),
	('2022-12-04', 13, 385, 446.6, 39),
	('2022-12-05', 13, 318, 368.88, 39),
	('2022-12-06', 13, 466, 540.56, 39),
	('2022-12-07', 13, 421, 488.36, 39),
	('2022-12-08', 13, 446, 517.36, 39),
	('2022-12-09', 13, 362, 419.92, 39),
	('2022-12-10', 13, 325, 377, 39),
	('2022-12-11', 13, 341, 395.56, 39),
	('2022-12-12', 13, 427, 495.32, Null),
	('2022-12-13', 13, 414, 480.24, Null),
	('2022-12-14', 13, 313, 363.08, Null),
	('2022-12-15', 13, 347, 402.52, Null),
	('2022-12-16', 13, 334, 387.44, Null),
	('2022-12-17', 13, 325, 377, 40),
	('2022-12-18', 13, 353, 409.48, 40),
	('2022-12-19', 13, 398, 461.68, 40),
	('2022-12-20', 13, 373, 432.68, Null),
	('2022-12-21', 13, 413, 479.08, 41),
	('2022-12-22', 13, 492, 570.72, 41),
	('2022-12-23', 13, 408, 473.28, Null),
	('2022-12-24', 13, 360, 417.6, 42),
	('2022-12-25', 13, 439, 509.24, 42),
	('2022-12-26', 13, 357, 414.12, 42),
	('2022-12-27', 13, 494, 573.04, 42),
	('2022-12-28', 13, 313, 363.08, 42),
	('2022-12-29', 13, 352, 408.32, Null),
	('2022-12-30', 13, 418, 484.88, Null),
	('2022-12-31', 13, 381, 441.96, Null),
	('2022-12-01', 14, 470, 545.2, 43),
	('2022-12-02', 14, 461, 534.76, 43),
	('2022-12-03', 14, 459, 532.44, 43),
	('2022-12-04', 14, 336, 389.76, 43),
	('2022-12-05', 14, 464, 538.24, 43),
	('2022-12-06', 14, 347, 402.52, Null),
	('2022-12-07', 14, 466, 540.56, Null),
	('2022-12-08', 14, 389, 451.24, Null),
	('2022-12-09', 14, 356, 412.96, Null),
	('2022-12-10', 14, 386, 447.76, Null),
	('2022-12-11', 14, 318, 368.88, 44),
	('2022-12-12', 14, 385, 446.6, 44),
	('2022-12-13', 14, 431, 499.96, 44),
	('2022-12-14', 14, 438, 508.08, 44),
	('2022-12-15', 14, 455, 527.8, 44),
	('2022-12-16', 14, 343, 397.88, 44),
	('2022-12-17', 14, 482, 559.12, Null),
	('2022-12-18', 14, 375, 435, Null),
	('2022-12-19', 14, 473, 548.68, Null),
	('2022-12-20', 14, 417, 483.72, Null),
	('2022-12-21', 14, 372, 431.52, Null),
	('2022-12-22', 14, 332, 385.12, Null),
	('2022-12-23', 14, 442, 512.72, Null),
	('2022-12-24', 14, 493, 571.88, Null),
	('2022-12-25', 14, 417, 483.72, Null),
	('2022-12-26', 14, 343, 397.88, Null),
	('2022-12-27', 14, 313, 363.08, Null),
	('2022-12-28', 14, 319, 370.04, Null),
	('2022-12-29', 14, 438, 508.08, Null),
	('2022-12-30', 14, 395, 458.2, Null),
	('2022-12-31', 14, 396, 459.36, Null),
	('2022-12-01', 15, 347, 402.52, Null),
	('2022-12-02', 15, 336, 389.76, 45),
	('2022-12-03', 15, 409, 474.44, 45),
	('2022-12-04', 15, 336, 389.76, 45),
	('2022-12-05', 15, 430, 498.8, 45),
	('2022-12-06', 15, 317, 367.72, 45),
	('2022-12-07', 15, 318, 368.88, 45),
	('2022-12-08', 15, 427, 495.32, 45),
	('2022-12-09', 15, 314, 364.24, 45),
	('2022-12-10', 15, 303, 351.48, 45),
	('2022-12-11', 15, 449, 520.84, 45),
	('2022-12-12', 15, 321, 372.36, Null),
	('2022-12-13', 15, 366, 424.56, Null),
	('2022-12-14', 15, 401, 465.16, Null),
	('2022-12-15', 15, 330, 382.8, Null),
	('2022-12-16', 15, 462, 535.92, Null),
	('2022-12-17', 15, 429, 497.64, 46),
	('2022-12-18', 15, 481, 557.96, 46),
	('2022-12-19', 15, 447, 518.52, 46),
	('2022-12-20', 15, 384, 445.44, Null),
	('2022-12-21', 15, 366, 424.56, 47),
	('2022-12-22', 15, 478, 554.48, 47),
	('2022-12-23', 15, 470, 545.2, Null),
	('2022-12-24', 15, 308, 357.28, 48),
	('2022-12-25', 15, 411, 476.76, 48),
	('2022-12-26', 15, 420, 487.2, 48),
	('2022-12-27', 15, 384, 445.44, 48),
	('2022-12-28', 15, 470, 545.2, 48),
	('2022-12-29', 15, 383, 444.28, Null),
	('2022-12-30', 15, 368, 426.88, Null),
	('2022-12-31', 15, 496, 575.36, Null),
	('2022-12-01', 16, 336, 389.76, 49),
	('2022-12-02', 16, 334, 387.44, 49),
	('2022-12-03', 16, 444, 515.04, 49),
	('2022-12-04', 16, 470, 545.2, 49),
	('2022-12-05', 16, 309, 358.44, 49),
	('2022-12-06', 16, 454, 526.64, Null),
	('2022-12-07', 16, 323, 374.68, Null),
	('2022-12-08', 16, 446, 517.36, Null),
	('2022-12-09', 16, 384, 445.44, Null),
	('2022-12-10', 16, 428, 496.48, Null),
	('2022-12-11', 16, 384, 445.44, 50),
	('2022-12-12', 16, 349, 404.84, 50),
	('2022-12-13', 16, 326, 378.16, 50),
	('2022-12-14', 16, 487, 564.92, 50),
	('2022-12-15', 16, 484, 561.44, 50),
	('2022-12-16', 16, 320, 371.2, 50),
	('2022-12-17', 16, 433, 502.28, Null),
	('2022-12-18', 16, 405, 469.8, Null),
	('2022-12-19', 16, 398, 461.68, Null),
	('2022-12-20', 16, 388, 450.08, Null),
	('2022-12-21', 16, 403, 467.48, Null),
	('2022-12-22', 16, 490, 568.4, Null),
	('2022-12-23', 16, 333, 386.28, Null),
	('2022-12-24', 16, 403, 467.48, Null),
	('2022-12-25', 16, 378, 438.48, Null),
	('2022-12-26', 16, 346, 401.36, Null),
	('2022-12-27', 16, 404, 468.64, Null),
	('2022-12-28', 16, 379, 439.64, Null),
	('2022-12-29', 16, 304, 352.64, Null),
	('2022-12-30', 16, 476, 552.16, Null),
	('2022-12-31', 16, 336, 389.76, Null),
	('2022-12-01', 17, 400, 464, Null),
	('2022-12-02', 17, 495, 574.2, Null),
	('2022-12-03', 17, 420, 487.2, Null),
	('2022-12-04', 17, 381, 441.96, 51),
	('2022-12-05', 17, 464, 538.24, 51),
	('2022-12-06', 17, 361, 418.76, 51),
	('2022-12-07', 17, 377, 437.32, 51),
	('2022-12-08', 17, 396, 459.36, 51),
	('2022-12-09', 17, 402, 466.32, 51),
	('2022-12-10', 17, 464, 538.24, 51),
	('2022-12-11', 17, 364, 422.24, 51),
	('2022-12-12', 17, 363, 421.08, 51),
	('2022-12-13', 17, 304, 352.64, 51),
	('2022-12-14', 17, 300, 348, 51),
	('2022-12-15', 17, 303, 351.48, 51),
	('2022-12-16', 17, 429, 497.64, 51),
	('2022-12-17', 17, 354, 410.64, 51),
	('2022-12-18', 17, 446, 517.36, 51),
	('2022-12-19', 17, 328, 380.48, Null),
	('2022-12-20', 17, 468, 542.88, Null),
	('2022-12-21', 17, 424, 491.84, Null),
	('2022-12-22', 17, 360, 417.6, Null),
	('2022-12-23', 17, 363, 421.08, Null),
	('2022-12-24', 17, 382, 443.12, Null),
	('2022-12-25', 17, 336, 389.76, Null),
	('2022-12-26', 17, 365, 423.4, Null),
	('2022-12-27', 17, 493, 571.88, Null),
	('2022-12-28', 17, 307, 356.12, Null),
	('2022-12-29', 17, 436, 505.76, Null),
	('2022-12-30', 17, 434, 503.44, Null),
	('2022-12-31', 17, 303, 351.48, Null),
	('2022-12-01', 18, 493, 571.88, Null),
	('2022-12-02', 18, 443, 513.88, Null),
	('2022-12-03', 18, 389, 451.24, Null),
	('2022-12-04', 18, 348, 403.68, Null),
	('2022-12-05', 18, 402, 466.32, Null),
	('2022-12-06', 18, 362, 419.92, Null),
	('2022-12-07', 18, 306, 354.96, Null),
	('2022-12-08', 18, 471, 546.36, 52),
	('2022-12-09', 18, 415, 481.4, Null),
	('2022-12-10', 18, 465, 539.4, Null),
	('2022-12-11', 18, 470, 545.2, Null),
	('2022-12-12', 18, 386, 447.76, 53),
	('2022-12-13', 18, 451, 523.16, 53),
	('2022-12-14', 18, 303, 351.48, 53),
	('2022-12-15', 18, 424, 491.84, 53),
	('2022-12-16', 18, 460, 533.6, 54),
	('2022-12-17', 18, 323, 374.68, Null),
	('2022-12-18', 18, 451, 523.16, Null),
	('2022-12-19', 18, 442, 512.72, Null),
	('2022-12-20', 18, 348, 403.68, 55),
	('2022-12-21', 18, 388, 450.08, 55),
	('2022-12-22', 18, 323, 374.68, 55),
	('2022-12-23', 18, 350, 406, 55),
	('2022-12-24', 18, 441, 511.56, 56),
	('2022-12-25', 18, 308, 357.28, 56),
	('2022-12-26', 18, 469, 544.04, 56),
	('2022-12-27', 18, 420, 487.2, 56),
	('2022-12-28', 18, 500, 580, 56),
	('2022-12-29', 18, 374, 433.84, Null),
	('2022-12-30', 18, 323, 374.68, Null),
	('2022-12-31', 18, 470, 545.2, Null),
	('2022-12-01', 19, 439, 509.24, Null),
	('2022-12-02', 19, 461, 534.76, Null),
	('2022-12-03', 19, 331, 383.96, Null),
	('2022-12-04', 19, 318, 368.88, 57),
	('2022-12-05', 19, 395, 458.2, 57),
	('2022-12-06', 19, 336, 389.76, 57),
	('2022-12-07', 19, 481, 557.96, 57),
	('2022-12-08', 19, 369, 428.04, 58),
	('2022-12-09', 19, 468, 542.88, 58),
	('2022-12-10', 19, 497, 576.52, Null),
	('2022-12-11', 19, 312, 361.92, 59),
	('2022-12-12', 19, 311, 360.76, 59),
	('2022-12-13', 19, 460, 533.6, Null),
	('2022-12-14', 19, 339, 393.24, Null),
	('2022-12-15', 19, 306, 354.96, Null),
	('2022-12-16', 19, 368, 426.88, Null),
	('2022-12-17', 19, 462, 535.92, Null),
	('2022-12-18', 19, 385, 446.6, Null),
	('2022-12-19', 19, 314, 364.24, Null),
	('2022-12-20', 19, 365, 423.4, Null),
	('2022-12-21', 19, 390, 452.4, Null),
	('2022-12-22', 19, 467, 541.72, Null),
	('2022-12-23', 19, 406, 470.96, Null),
	('2022-12-24', 19, 329, 381.64, Null),
	('2022-12-25', 19, 441, 511.56, Null),
	('2022-12-26', 19, 341, 395.56, Null),
	('2022-12-27', 19, 419, 486.04, Null),
	('2022-12-28', 19, 377, 437.32, Null),
	('2022-12-29', 19, 378, 438.48, Null),
	('2022-12-30', 19, 411, 476.76, Null),
	('2022-12-31', 19, 305, 353.8, Null),
	('2022-12-01', 20, 329, 381.64, 60),
	('2022-12-02', 20, 331, 383.96, 60),
	('2022-12-03', 20, 358, 415.28, 60),
	('2022-12-04', 20, 378, 438.48, 60),
	('2022-12-05', 20, 325, 377, 60),
	('2022-12-06', 20, 471, 546.36, 60),
	('2022-12-07', 20, 365, 423.4, 60),
	('2022-12-08', 20, 315, 365.4, 60),
	('2022-12-09', 20, 402, 466.32, 60),
	('2022-12-10', 20, 383, 444.28, 60),
	('2022-12-11', 20, 321, 372.36, 60),
	('2022-12-12', 20, 468, 542.88, 60),
	('2022-12-13', 20, 476, 552.16, 60),
	('2022-12-14', 20, 375, 435, 60),
	('2022-12-15', 20, 481, 557.96, 60),
	('2022-12-16', 20, 498, 577.68, 60),
	('2022-12-17', 20, 436, 505.76, 60),
	('2022-12-18', 20, 311, 360.76, 60),
	('2022-12-19', 20, 394, 457.04, 60),
	('2022-12-20', 20, 385, 446.6, 60),
	('2022-12-21', 20, 360, 417.6, Null),
	('2022-12-22', 20, 495, 574.2, Null),
	('2022-12-23', 20, 410, 475.6, Null),
	('2022-12-24', 20, 415, 481.4, Null),
	('2022-12-25', 20, 363, 421.08, Null),
	('2022-12-26', 20, 393, 455.88, Null),
	('2022-12-27', 20, 407, 472.12, Null),
	('2022-12-28', 20, 492, 570.72, Null),
	('2022-12-29', 20, 462, 535.92, Null),
	('2022-12-30', 20, 443, 513.88, Null),
	('2022-12-31', 20, 499, 578.84, Null);
    
Insert into transaccion (id_reservacion, monto, metodo_pago, estatus_pago) 
Values
	(1, 2340.88, 'Credit Card', 1),
	(2, 2009.12, 'Credit Card', 0),
	(3, 4369.72, 'Credit Card', 1),
	(4, 4569.24, 'Credit Card', 0),
	(5, 1488.28, 'Credit Card', 1),
	(6, 837.52, 'Credit Card', 1),
	(7, 2513.72, 'Cash', 1),
	(8, 2285.2, 'Credit Card', 1),
	(9, 1269.04, 'Credit Card', 1),
	(10, 1338.8, 'Credit Card', 1),
	(11, 2209.8, 'Credit Card', 1),
	(12, 2904.64, 'Cash', 1),
	(13, 4421.92, 'Credit Card', 1),
	(14, 2467.32, 'Credit Card', 1),
	(15, 460.52, 'Credit Card', 1),
	(16, 921.04, 'Cash', 1),
	(17, 3086.76, 'Credit Card', 1),
	(18, 3061.24, 'Credit Card', 1),
	(19, 1859.48, 'Credit Card', 1),
	(20, 1893.12, 'Credit Card', 1),
	(21, 976.72, 'Credit Card', 1),
	(22, 1727.24, 'Credit Card', 1),
	(23, 6796.44, 'Credit Card', 0),
	(24, 453.56, 'Credit Card', 1),
	(25, 1854.84, 'Credit Card', 1),
	(26, 542.88, 'Credit Card', 1),
	(27, 1541.64, 'Credit Card', 1),
	(28, 2079.88, 'Credit Card', 1),
	(29, 946.56, 'Credit Card', 1),
	(30, 4695.68, 'Credit Card', 1),
	(31, 1900.08, 'Credit Card', 1),
	(32, 2101.92, 'Credit Card', 1),
	(33, 2346.68, 'Credit Card', 1),
	(34, 578.84, 'Credit Card', 1),
	(35, 969.76, 'Credit Card', 1),
	(36, 2782.84, 'Credit Card', 1),
	(37, 3040.36, 'Credit Card', 1),
	(38, 2236.48, 'Credit Card', 1),
	(39, 4468.32, 'Credit Card', 1),
	(40, 1248.16, 'Credit Card', 1),
	(41, 1049.8, 'Credit Card', 1),
	(42, 2277.08, 'Credit Card', 1),
	(43, 2540.4, 'Credit Card', 1),
	(44, 2749.2, 'Credit Card', 1),
	(45, 4221.24, 'Credit Card', 1),
	(46, 1574.12, 'Credit Card', 1),
	(47, 979.04, 'Credit Card', 1),
	(48, 2311.88, 'Credit Card', 1),
	(49, 2195.88, 'Credit Card', 1),
	(50, 2726, 'Credit Card', 1),
	(51, 6621.28, 'Credit Card', 1),
	(52, 546.36, 'Cash', 1),
	(53, 1814.24, 'Credit Card', 1),
	(54, 533.6, 'Credit Card', 1),
	(55, 1634.44, 'Credit Card', 1),
	(56, 2480.08, 'Cash', 1),
	(57, 1774.8, 'Credit Card', 0),
	(58, 970.92, 'Cash', 1),
	(59, 722.68, 'Credit Card', 1),
	(60, 9050.32, 'Credit Card', 1);

INSERT INTO compra_adicional (id_reservacion,id_producto)
Values
	(31,3),
	(6,1),
	(7,2),
	(29,9),
	(35,4),
	(49,11),
	(11,7),
	(17,7),
	(52,8),
	(32,1),
	(30,4),
	(57,10),
	(56,9),
	(37,1),
	(42,11),
	(2,1),
	(41,11),
	(54,1),
	(58,2),
	(4,8);
    
    
/* Create Vistas */
CREATE VIEW `view_daily_revenue` AS
Select fecha, sum(tarifa_abierta_bruta) from calendario_tarifa
Where id_reservacion is not null
group by fecha;

CREATE VIEW `view_total_occ` AS
select 
	(select count(id_reservacion) from calendario_tarifa
	where id_reservacion is not null)/
    count(*) as Total_occupancy
	from calendario_tarifa;

CREATE VIEW `view_guests_by_country` AS
Select direccion.pais, count(id_huesped) as guest_count from huespedes
	join direccion on huespedes.id_direccion = direccion.id_direccion
    group by direccion.pais;

CREATE VIEW `reservations_by_channel` AS
Select canales.canal, count(id_reservacion) from reservaciones
	join canales on canales.id_canal = reservaciones.id_canal
    group by canales.canal;

CREATE VIEW `ADR_by_room` AS
Select id_habitacion, round(avg(tarifa_abierta_bruta),2) as ADR from calendario_tarifa
	Where id_reservacion is not null
    group by id_habitacion
    order by id_habitacion asc;

/* Create Functions */
CREATE DEFINER=`root`@`localhost` FUNCTION `ADR_function`(start_date DATE, end_date DATE) RETURNS float
    READS SQL DATA
BEGIN
DECLARE ADR FLOAT;
SET ADR = (
	SELECT ROUND(AVG(tarifa_abierta_bruta),2) FROM calendario_tarifa
    Where fecha>=start_date
		and fecha<=end_date
		);
RETURN ADR;
END

CREATE DEFINER=`root`@`localhost` FUNCTION `occupancy_function`(start_date DATE, end_date DATE) RETURNS float
    READS SQL DATA
BEGIN
	DECLARE occupancy FLOAT;
    SET occupancy = (
		SELECT
			((	Select count(id_reservacion) 
				from calendario_tarifa
				Where id_reservacion is not null
					and fecha >=start_date
                    and fecha <=end_date)
                / count(*)
			)
        FROM calendario_tarifa
        Where fecha >=start_date
			and fecha <=end_date);
RETURN occupancy;
END

/* Create Stored Procedures */
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_compra_adicional`(IN reservation int, product_id int)
BEGIN
    /* insert product purchase into reservation bill */
    set @clausula2 = concat("Insert into compra_adicional(id_reservacion,id_producto) values (", reservation, ", ", product_id, ")");
    select @clausula2;
    Prepare execinsert from @clausula2;
    Execute execinsert;
    Deallocate prepare execinsert;
END

CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_order_reservation`(IN field char(100), ascdesc char(4))
BEGIN
	/*order reservations table by selected column ascending or descending*/
	If field <> '' then
		Set @reservation_order = concat('Order by ', field," ", ascdesc);
	Else
		SET @reservation_order = '';
	End if;
	Set @clausula = concat('select * from hotel_model.reservaciones ',@reservation_order);
    prepare runclause from @clausula;
    execute runclause;
    deallocate prepare runclause;
END

/* Create Triggers */
use hotel_model;

-- Creamos tablas LOG, para monitorear inserciones de reservaciones y huéspedes
create table new_reservations (
	id_reservacion int PRIMARY KEY,
    added_by varchar(100),
    fecha date,
    hora date
);

create table new_huespedes (
	id_huesped int PRIMARY KEY,
    added_by varchar(100),
    fecha date,
    hora date
);

-- Los triggers se detonaran cada vez que un usuario inserta un usuario o reservación
-- almacenando el id del registro junto con datos del db user y timestamp de la inserción
create trigger tr_add_reservation
before insert on reservaciones
for each row
insert into new_reservations (id_reservacion, added_by, fecha, hora) 
values (new.id_reservacion, user(), current_date(), current_time());


create trigger tr_add_huesped
after insert on huespedes
for each row
insert into new_huespedes (id_huesped, added_by, fecha, hora) 
values (new.id_huesped, user(), current_date(), current_time());

INSERT INTO reservaciones (id_huesped,id_habitacion, id_canal, check_in, check_out, num_huespeded, estatus)
Values
	(5,2,3, '2022-12-05', '2022-12-06', 4, 'Cancelled');
    
Insert into huespedes (nombre, apellido, correo,id_direccion,telefono)
Values
	('David','Santos','d.santos@randatmail.com',31,'69266862');
    
/*TCL Language Example*/

/*In the first table, if it has registers, eliminate some in a transaction*/
Set autocommit = 0;
Start transaction; 
Delete from transaccion 
where
	id_transaccion >= 50;
Select * from transaccion;
/*Rollback*/
Rollback;
Select * from transaccion;
/*Commit*/
Commit;
Select * from transaccion;

/*In the second table, insert 8 new registers in a trasnaction*/
Start transaction; 
INSERT INTO compra_adicional (id_reservacion, id_producto) values (1,2);
INSERT INTO compra_adicional (id_reservacion, id_producto) values (3,1);
INSERT INTO compra_adicional (id_reservacion, id_producto) values (4,5);
INSERT INTO compra_adicional (id_reservacion, id_producto) values (10,7);
/*Add a savepoint after register 4*/
savepoint insert_4_compras;
INSERT INTO compra_adicional (id_reservacion, id_producto) values (2,1);
INSERT INTO compra_adicional (id_reservacion, id_producto) values (1,3);
INSERT INTO compra_adicional (id_reservacion, id_producto) values (5,4);
INSERT INTO compra_adicional (id_reservacion, id_producto) values (7,10);
/*Add another savepoint after register 8*/
savepoint insert_8_compras;
/*Eliminate the savepoint after 4*/
Rollback to insert_4_compras;
select * from compra_adicional;
Set autocommit = 1;

